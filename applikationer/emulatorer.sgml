<!-- $Id$ -->
<chapter id="emulatorer">
<title>Emulatorer</title>
<indexterm><primary>VMware</primary></indexterm>
<indexterm><primary>win4lin</primary></indexterm>
<indexterm><primary>Plex86</primary></indexterm>
<indexterm><primary>Emulator</primary><secondary>VMware</secondary></indexterm>
<indexterm><primary>Emulator</primary><secondary>SCO</secondary></indexterm>

<para>
En emulator er et program, som gør det muligt at afvikle programmer
skrevet til en anden computer eller styresystem. Vi vil i dette afsnit 
se på en række forskellige emulatorer, som du kan benytte under Linux.
</para>

<para>
Med hensyn til emulatorer kan Linux køre SCO programmer
(en kommerciel Unix-variant) gennem det, der hedder iBCS biblioteket (Intel
Binary Code Standard). Dette giver adgang til en del ekstra
kommercielle database-programmer. 
</para>

<para>
Har du en kraftig (gerne 128 MB RAM) og hurtig PC (gerne mere end 266
MHz Pentium II), kan du <emphasis>købe</emphasis> VMware, som laver en
emuleret processor og kobling til maskinen.  Så kan du køre dine
Windows-programmer samtidig med, at du kører dine Linux-programmer -
og principielt kan alle programmer køre. VMware kræver naturligvis, at
Windows er installeret på computeren.  VMware findes på <ulink
url="http://www.vmware.com">http://www.vmware.com</ulink>
</para>


<para>
Et alternativ er <command>win4lin</command>, som også er på vej
frem. Denne kan købes fra <ulink
url="http://www.netraverse.com">http://www.netraverse.com</ulink>.
Win4lin kræver umiddelbart langt færre ressourcer end VMware, men har
også et par begrænsninger, såsom at kerne 2.4 ikke understøttes, der
findes ingen "network neighborhood", man skal sambamounte (eller nfs)
mounte netværksdrev, før man starter <command>win4lin</command>, og i
en tabel til <command>win4lin</command> angive, hvordan drevbogstaver
mappes. Dette vil være noget i retning af: C: Mappes til
<filename>/home/bruger/win</filename> M: Mappes til
<filename>/nfs/server/directory</filename> etc. Hukommelse kan
tildeles til Windows fra 20MB op til max. 64MB.  Der er også
begrænsninger i den grafik, der kan understøttes.
</para>

<para>
Hvor VMware og win4lin er kommercielle pakker, så er et frit projekt
<command>Plex86</command> på vej. Dog er det endnu ikke anvendeligt
og er ekstremt langsomt.
</para>


<FIGURE ID="fig-win4lin" FLOAT="1">
<TITLE>Windows kører under Linux via Win4lin</TITLE>
<GRAPHIC FILEREF="win4lin.&magic;"  SCALE="40"></GRAPHIC>
</FIGURE>


<sect1 id="dosemu">
<title>DOS-emulatoren dosemu</title>
<indexterm><primary>DOS</primary><secondary>emulering, dosemu</secondary></indexterm>
<indexterm><primary>Emulator</primary><secondary>dosemu, FreeDOS</secondary></indexterm>

<para>
Mangler du specifikke DOS-programmer under Linux, kan du få en
DOS-emulator (<command>dos</command> (konsol-orienteret) og
<command>xdos</command> (X-baseret)), således at du under Linux kan
køre DOS-programmer. Programmet kan sågar køre grafikprogrammer
(f.eks. Windows 3.1) - dog ikke nyere Win32 programmer. Du kan
f.eks. anvende DOS-emulatoren til at køre Gyldendals røde ordbøger.
</para>

<para>
DOS-emulatoren består egentlig af to dele. Den ene del gør det muligt
at køre DOS-programmer under Linux, mens den anden del er selve
styresystemet DOS. Der følger en DOS ved navn FreeDOS med, men du kan
i princippet bruge din egen, f.eks. hvis du en gang har købt DOS og
stadig har installationsdisketterne liggende. I det følgende vil vi
dog kun benytte FreeDOS. Begge dele er indeholdt i dosemu-pakken.
</para>

<para>
Lad det være sagt med det samme: den version af DOS-emulatoren, som
følger med Red Hat virker <emphasis>ikke</emphasis>. Grunden er
den simple, at Red Hat har valgt at benytte den nyeste version. Men
denne version er for udviklerne, dvs. den er fuld af fejl og
mangler. Derfor skal du først nedgradere dit system til den stabile
version. Nedenfor ser du, hvordan du gør det.
</para>

<screen>
<prompt>[root@linus root]# </prompt><userinput>rpm -e dosemu-freedos-0.99.10-4</userinput>
<prompt>[root@linus root]# </prompt><userinput>rpm -e xdosemu-0.99.10-4</userinput>
<prompt>[root@linus root]# </prompt><userinput>rpm -e dosemu-0.99.10-4</userinput>
<prompt>[root@linus root]# </prompt><userinput>rpm -i dosemu-0.98.8-1.i386.rpm</userinput>
</screen>

<para>
Filen <filename>dosemu-0.99.8-1.i386.rpm</filename> kan du hente fra <ulink
url="ftp://sunsite.auc.dk/pub/os/linux/sunsite/system/emulators/dosemu">ftp://sunsite.auc.dk/pub/os/linux/sunsite/system/emulators/dosemu</ulink>.
For at få DOS-emulatoren til at virke skal du have DOS installeret.
Nedgraderer du som anvist ovenfor, kan du let få en gratis DOS (FreeDOS). Du
skal blot omdøbe filen <filename>hdimage.first.rpmsave</filename> i
kataloget <filename>/var/lib/dosemu</filename> til
<filename>hdimage.first</filename>.
</para>

<screen>
<prompt>[root@linus root]# </prompt><userinput>cd /var/lib/dosemu </userinput>
<prompt>[root@linus dosemu]# </prompt><userinput>mv hdimage.first.rpmsave hdimage.first</userinput>
</screen>

<para>
Eftersom du under DOS kan rode direkte med hardware (som du ikke som
almindelig bruger under Linux kan), kan kun root køre
DOS-emulatoren. Hvis du ønsker at ændre dette, skal du rette i filen
<filename>/etc/dosemu.users</filename>. Den RPM-fil, som du har
installeret som anvist ovenfor, tillader at alle bruger den, så du skal
ikke rette noget.
</para>

<para>
Under en standard installation af dosemu-pakken oprettes et billede
af en harddisk. Billedet emulerer C-drevet. Dette billede finder du
(under Red Hat 6.0) som
<filename>/var/lib/dosemu/hdimage.first</filename>. Det er let at
hente og gemme filer på dette billede fra Linux. Du skal blot føje
linjen 
<screen>drive g:  file="/var/lib/dosemu/hdimage" Offset=8832</screen> 
til <filename>/etc/mtools.conf</filename>, og nu 
kan du bruge <command>mcopy</command>, <command>mdir</command> osv.
</para>

<para>
Vil du vide mere om DOS-emulatoren, er <ulink
url="http://www.dosemu.org">http://www.dosemu.org</ulink> et godt sted 
at begynde. FreeDOS finder du på <ulink
url="http://www.freedos.org">http://www.freedos.org</ulink>
</para>

<FIGURE ID="fig-dosemu" FLOAT="1">
<TITLE>WordPerfect 5.1 i DOS-emulatoren</TITLE>
<GRAPHIC FILEREF="wp51-dosemu.&magic;"  SCALE="40"></GRAPHIC>
</FIGURE>
</sect1>

<sect1 id="WINE">
<title>Windows-emulatoren WINE</title>
<indexterm><primary>Wine</primary></indexterm>
<para>
Der har længe været programmeret på WINE (<ulink
url="http://www.winehq.com">http://www.winehq.com</ulink>) - et
program til at kunne køre Windows-emulator under Linux - og projektet
virker mere lovende nu efter lang tids stilstand. På grund af
Microsofts lukkede politik er det ikke alt, teamet har kunnet få
tekniske detaljer på, og derfor er det langtfra sikkert, at du kan få
nyere Windows-programmer til at køre på denne måde under Linux. WINE står
for Wine Is Not an Emulator!
</para>

<para>
WINE er på ingen måder et færdigt produkt endnu, men det er muligt at
finde "snapshots" af WINE rundt om på Internettet. Nedenfor viser vi,
hvordan et "snapshot" fra  den 28. marts 1999 installeres (filen er
fundet på <ulink
url="ftp://sunsite.auc.dk">ftp://sunsite.auc.dk</ulink>). 

</para>

<screen>
<prompt>[anne@linus ~]$ </prompt> <userinput>su -</userinput>
Password: 
<prompt>[root@linus root]# </prompt> <userinput>rpm -i wine-990328-1.i386.rpm</userinput>
</screen>

<para>
Inden du kan komme i gang med at bruge WINE, bør du se lidt på
konfigurationen af WINE, som sker i filen
<filename>/etc/wine.conf</filename>. Du skal først og fremmest
tilrette filen, så stier til dine Microsoft Windows-kataloger er
korrekte. Når du ønsker at køre et Windows-program, bruger du
kommandoen <command>wine</command> (efterfulgt af navnet på det
program, du ønsker at køre). Nedenfor ser du et eksempel på brugen af
WINE - kabalespillet fra Windows kører, og <command>gtop</command> ses
i baggrunden.
</para>

<FIGURE ID="wine-fig" FLOAT="1">
<TITLE>Windows-emulatoren WINE</TITLE>
<GRAPHIC FILEREF="wine.&magic;"  SCALE="40"></GRAPHIC>
</FIGURE>


<para>
Lad os bare indrømme det: vi har forsøgt med en del
Windows-programmer, og kun få har virket i WINE. Men selvom WINE ikke
virker helt endnu, er det nu alligevel værd at følge med i udviklingen 
og prøve et "snapshot" i ny og næ.
</para>

 <para>
  Slutteligt bør det nævnes, at der også findes en kommerciel Windows-emulator
  ved navn WABI.
 </para>
</sect1>

<sect1 id="VICE">
 <title>Commodore-emulering</title>

 <indexterm><primary>C64</primary></indexterm>
 <indexterm><primary>emulator</primary>
            <secondary>Commodore 64</secondary></indexterm>

 <para>
  Hvis du som denne bogs forfattere er vild med din gamle Commodore 64, er
  VICE noget for dig. VICE er en forkortelse for "Versatile Commodore 8-bit
  Emulator" (eller måske VIC Emulator). VICE kan emulere Commodore 64,
  Commodore 128, VIC 20 og Commodore PET. Ud over udgaver til Linux (Unix)
  findes VICE til MS-DOS og Windows. VICE er i sandhed en alsidig emulator.
 </para>

<para>
VICE følger ikke med en standard Red Hat distribution, men du finder
den let på et ftp-site, f.eks. <ulink url="ftp://sunsite.auc.dk">ftp://sunsite.auc.dk</ulink> under Red
Hat-contrib. Installationen kan drille lidt, idet VICE kræver
<filename>libstdc++</filename> version 2.9. Dette bibliotek er
installeret ved en standard installation, men navnet kan være
forkert. Nedenfor ser du, hvordan du kan installere VICE - du bør
tjekke, hvilket navn <filename>libstdc++</filename> har i
<filename>/usr/lib</filename>.
</para>

<screen>
<prompt>[anne@linus ~]$ </prompt> <userinput>su -</userinput>
Password: 
<prompt>[root@linus root]# </prompt> <userinput>cd /usr/lib</userinput>
<prompt>[root@linus root]# </prompt> <userinput>ln -s libstdc++-2-libc6.1-1-2.9.0.so libstdc++.so.2.9</userinput>
<prompt>[root@linus root]# </prompt> <userinput>rpm -ivh --nodeps vice-1.0-1.i386.rpm</userinput>
</screen>

<para>
Efter installationen er du klar til at bruge VICE. Afhængigt af, hvilken
Commodore-computer, du ønsker at emulere, skal du benytte et af
følgende programmer: <command>x64</command> (Commodore 64),
<command>x128</command> (Commodore 128), <command>xvic</command> (VIC
20) eller <command>xpet</command> (PET).
</para>

<para>
VICE kan emulere lyd og grafik samt ydre enheder, dvs. båndstationer,
diskettestationer (Commodore 1571) og joystick. Din emulator kører i
et selvstændigt vindue under X. Højre og venstre museknap giver dig
menuer til at styre VICE. Bånd og disketter emuleres ved, at du har
indholdet liggende i en fil på din harddisk. Trykker du på venstre
museknap, kan du "attach a disk image" og "attach a tape image",
dvs. du kan vælge, hvilken fil der er dit bånd eller din
diskette. Bånd og disketter gemmes i særlige formater.
</para>

<para>
Det er let at finde gamle spil til f.eks. Commodore 64 rundt om på
Internettet. Tjek f.eks. <ulink
url="http://www.c64.com">http://www.c64.com</ulink> som har ca. 2500
liggende.
</para>

<FIGURE ID="vice-fig" FLOAT="1">
<TITLE>Spillet Soccer</TITLE>
<GRAPHIC FILEREF="vice.&magic;"  SCALE="40"></GRAPHIC>
</FIGURE>
</sect1>

<sect1 id="vnc">
<title>VNC til fjernstyring af dine maskiner</title>

<!-- Dette afsnit er skrevet af Bent Pedersen bentriloquist@my-deja.com -->
<para>
VNC står for Virtual Network Computing. Kender du
programmer som PC Anywhere eller NetOp, som begge kører på
Windows-platformen, så har du en god idé om hvad VNC er: et program
til fjernstyring af en anden PC med grafisk brugerflade. 
Dog kører VNC over TCP/IP, og ikke
andet. VNC består af en server-del, som kører på den maskine du ønsker
at fjernstyre, samt en klient-del, som kører på den maskine du sidder
foran.
</para>

<sect2 id="vnc-ide"> <!-- Af Erling Sjørlund es@es-data.dk -->
<title>Integration af serveren på arbejdspladsen med VNC</title>
<para>
Hvis du har et lille system med en Linuxserver og en eller flere
arbejdspladser med Windows, kan du med VNC få en let og effektiv adgang til
at arbejde med serveren direkte på din arbejdsplads.
Installer først vncserver på din Linux-server. Log ind på serveren på dit
almindelige brugernavn (ikke root), og start vncserveren, fx. med :1 som
nummer. Log ind under et andet brugernavn og start vncserver igen, her med
:2 som nummer.
</para>

<para>
Hvert nummer har sin egen opsætning, så du kan evt. starte en vncserver til
hvert familiemedlem, efter at du har logget ind på serveren som vedkommende.
Start derefter vncviewer på din arbejdsplads i et vindue, og log ind med det
password du oplyste første gang vncserver blev startet (på Linux-serveren
under det :nummer du bruger). Det letteste er nok at bruge dens IP-nummer,
altså fx. 192.168.1.1:1, hvor det sidste :1 skal svare til det nummer du gav
på serveren.
</para>

<para>
Nu har du et miljø, hvor du uden videre kan veksle mellem vinduet med
serverens X-variant og Windows-brugerfladen. Du kan direkte klippe-klistre
tekst mellem Linux- og Windowsprogrammer, og i det hele taget gøre på
serveren hvad din adgang tillader dig.
Hvis du ikke har behov for at skifte bånd, CD'er, disketter eller lignende
på din server, kan du nu parkere din server så langt væk som muligt, (fx. i
kælderen, så den kan bidrage til opvarmningen af huset).
</para>

<para>
Du får nu disse fordele:
</para>

<itemizedlist mark="bullet">
<listitem>
 <para>
Serveren skal hverken have skærm, mus eller tastatur for at kunne anvendes
fuldt ud.
 </para>
</listitem>
<listitem> 
 <para>
Du kan (mere eller mindre frivilligt) lukke Windows ned på din
arbejdsplads. Næste gang du åbner Windows+vncviewer, vil den kun vise en blå
skærm, hvis det er den farve, du har valgt frivilligt. (Det forudsættes her,
at du ikke sådan går rundt og lukker din server i tide og utide).
 </para>
</listitem>
<listitem> 
 <para>
Du kan arbejde sammen med din mand/kone i den samme skærm uden at skulle
slås om tastatur, mus og overblik. I login-dialogen (Billede ind
heromkring?) klikker du blot på knappen [Options], og afkrydser "Request
shared session" nederst i venstre hjørne. Det, den ene skriver, bliver
blandet ind i det, den anden er i gang med. Skulle I blive trætte af det,
(og det kan ske selv i de bedste forhold), kan man naturligvis også arbejde
samtidigt på hver sin maskine, uden at blande sig sammen. Det kræver blot,
at du starter vncserver flere gange på Linux-serveren med hvert sit :nummer,
og logger ind fra arbejdspladserne med forskellige numre.
 </para>
</listitem>
<listitem> 
 <para>
Har du børn med egen maskine i familien (det har man hørt om), kan du
installere vncserver på deres maskiner, og kigge dem over skulderen, helt
uden at de behøver at opdage det.
På den måde slipper du for at komme alt for tæt på dem, og du ved alt hvad
de gør uden at tale med dem først. Det hele bliver som i de gode gamle dage,
hvor jeg er sikker på, at alle mødre havde et lignende system, der gjorde,
at de næsten altid vidste, hvad deres børn havde gang i.
 </para>
</listitem>
</itemizedlist>

</sect2>



<sect2 id="vnc-installation">
<title>Installation af VNC</title>

<para>
For eksemplets skyld antages, at du ønsker at fjernstyre din
Linux-maskine fra en Windows-maskine. Du skal altså hente en
Linux-server og en Windows-klient.  Man kan også fjernbetjene en
Windows-maskine - selv mens andre sidder ved maskinen. Yderst smart
til support.
</para>

<para>
Først skal VNC-serveren hentes. Det kan gøres fra
<ulink url="http://www.uk.research.att.com/vnc">http://www.uk.research.att.com/vnc</ulink>, som er det sted hvor udviklerne
lægger kildekoden. Desværre kan man derfra ikke hente RPM-pakker,
men gå til 
<ulink url="http://www.rpmfind.net">http://www.rpmfind.net</ulink>
og søg efter <EMPHASIS>vnc-server</EMPHASIS>.
Version 3.3.3r2 eller nyere kan findes der.
</para>

<para>
VNC-serveren skal installeres som root:
</para>

<screen>
<prompt>[root@linus root]# </prompt><userinput>rpm -Uvh vnc-server-3.3.3r2-4.i386.rpm</userinput>
</screen>
</sect2>

<sect2 id="vnc-server-start">
<title>Start en server</title>
<para>
vncservers man-side oplyser følgende:
</para>

<screen>
vncserver [:number] [-geometry widthxheight] [-depth depth] 
 [-pixelformat rgbNNNbgrNNN] [-name desktop-name] [Xvnc-options]
</screen>

<para>
Der er altså mange options, men du behøver kun ganske få for at komme igang.
</para>

<para>
Et eksempel på start af VNC-server:
</para>

<screen>
<prompt>[anne@linus ~]$ </prompt><userinput>vncserver :1 geometry 800x600 depth 8</userinput>
</screen>

<para>
Hvilket betyder: lav en ny X-desktop med størrelsen 800x600 pixels og
8 bits pr pixel (=256 farver) og lyt på TCP/IP 5801. 5801? Ja, for VNC
lægger automatisk 5800 til det nummer man angiver, og bruger det som
port-nummer.
</para>

<para>
Du kan bruge en hvilket som helst størrelse du ønsker, også skæve
størrelser som f.eks. 200x500, hvis du ønsker det. Vær opmærksom på,
at jo større desktop du bruger, desto mere skal der sendes på nettet,
og det giver reduceret hastighed. 
En mulig opløsning kunne være 800x600x8bpp til VNC-serveren, selv om
den fysiske desktop kører 1024x800x16bpp. Ved at vælge denne mindre
opløsning giver det 3,5 gange mindre trafik.

Desuden er et baggrundsbillede
også vejen til langsom hastighed, så brug en ensfarvet baggrund i
stedet for dine feriebilleder.
</para>

<para>
Første gang du starter vncserver, skal du angive et password. Dette
password skal du opgive, når du senere forsøger at forbinde dig til
maskinen. Hvis du ønsker at ændre passwordet kan du blot køre
programmet vncpasswd.
</para>

<para>
Når du vil lukke din VNC-server igen foregår det sådan:

</para>

<screen>
<prompt>[anne@linus ~]$ </prompt><userinput>vncserver -kill :1</userinput>
</screen>

</sect2>

<sect2 id="vnc-opsaetning">
<title>Opsætning</title>

<para>
Bruger du fx Gnome som dekstop,
er det en fordel at bruge en anden Window Manager når kobler op til VNC.
Et valg kunne være IceWM der føles en lille smule hurtigere,
og hver lille smule hastighed tæller.
</para>

<para>
Af dokumentationen fremgår det at <command>vncserver</command> bruger
<filename>$HOME/.vnc/xstartup</filename> som startfil. Det er altså
stedet, hvor sådanne ændringer skal laves. 
En eksempel på en ændret xstartup kan se således ud:
</para>

<screen>
#!/bin/sh
xrdb $HOME/.Xdefaults &
exec icewm
</screen>

<para>
Hvis du i stedet ønskede at bruge Gnome, så skulle linien med exec
icewm ændres til <command>exec gnome-session</command> og tilsvarende
anvender KDE <command>exec startkde</command>. Dette kræver
selvfølgelig, at IceWM, Gnome og/eller KDE er installeret i forvejen.
</para>

<para>
Bemærk i øvrigt at standard window manager for VNC er
<command>twm</command>, som vel kun de færreste ønsker at bruge.
</para>
</sect2>

<sect2 id="vnc-klienten">
<title>Klienten</title>
<para>
  Der findes klienter til både Windows og Linux. Da disse er oversat specifikt
  til det relevante system er de mindre processorkrævende. Men den smarteste
  klient er dog den til Java.
</para>

<para> 
  Har du en browser, der kan snakke Java, så gå ind
  på: <filename>http://x.x.x.x:5901</filename>. 
  Her angiver du brugernavn og adgangskode
  hvorefter du i din browser kan fjernstyre maskinen.       
</para>

<FIGURE ID="vnc1-fig" FLOAT="1">
<TITLE>VNC - hvor en Linux-maskine styres fra en Internet Explorer fra Windows</TITLE>
<GRAPHIC FILEREF="vnc1.&magic;"  SCALE="40"></GRAPHIC>
</FIGURE>

<FIGURE ID="vnc2-fig" FLOAT="1">
<TITLE>VNC - hvor en Windows-maskine styres fra en Linux-maskine via Netscape</TITLE>
<GRAPHIC FILEREF="vnc2.&magic;"  SCALE="40"></GRAPHIC>
</FIGURE>

</sect2>

<sect2 id="vnc-pas-paa">
<title>Pas på din sikkerhed</title>

<para>
Bemærk at <command>vncserver</command> giver brugeren af klienten de
samme rettigheder, som den konto der startede den.  Er du logget ind
som "guest" når du starter <command>vncserver</command>, får alle der
logger på via en vnc-klienten "guest" rettigheder.  Af hensyn til
sikkerheden bør du derfor ikke starte den som root, og det er også
klogt at huske nedlukning af vncserver, når den ikke skal bruges.
 </para>

<para>
Bemærk også, at hvis du har startet vncserver direkte i en konsol på
serveren, så bliver den ved at køre, også selv om du forsøgt logout.      
</para>

<para>
VNC er en åbning af et potentielt sikkerhedshul - i hvertfald er
versioner op til og med 3.3.3 ikke sikre, jfr. Weekly Linux Security
Digest 2001/01/22-2001/01/28. I de ældre versioner kan man bryde ind i
trafikken mellem server og klient.

</para>
</sect2>
</sect1>
</chapter>
